(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab84c"],{"162c":function(e,t,i){"use strict";i.r(t);i("b0c0");var l=function(){var e=this,t=e._self._c;return t("el-container",[t("el-main",[t("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{model:e.searchForm,"label-width":"120px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:18}},[t("el-row",{staticClass:"param-row"},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[t("el-input",{attrs:{maxlength:"60"},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1)],1)],1)],1),t("el-col",{attrs:{span:6}},[t("el-row",{attrs:{type:"flex",justify:"center"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),t("el-button",{on:{click:e.handleSearchClear}},[e._v("清空")])],1)],1)],1)],1),t("div",{staticClass:"content"},[t("el-alert",{staticClass:"alert",attrs:{title:"",type:"info",closable:!1}},[t("div",{staticClass:"left"},[e._v(" 医生管理 ")]),t("div",{staticClass:"right"},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleAdd}},[t("i",{staticClass:"el-icon-plus"}),e._v(" 新增 ")]),t("el-button",{attrs:{loading:e.downloadLoading,size:"mini",type:"primary"},on:{click:e.handleDownload}},[t("i",{staticClass:"el-icon-download"}),e._v(" 导出 ")])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.table.tableLoading,expression:"table.tableLoading"}],staticClass:"table",attrs:{data:e.table.list,border:""}},[t("el-table-column",{attrs:{label:"医生序号","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.id))])]}}])}),t("el-table-column",{attrs:{label:"医生名称","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.name))])]}}])}),t("el-table-column",{attrs:{label:"医生详情图片","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(i){return e._l(i.row.img,(function(e,i){return t("el-image",{key:i,staticStyle:{width:"150px",height:"75px"},attrs:{src:e}})}))}}])}),t("el-table-column",{attrs:{label:"医生头像","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-image",{staticStyle:{width:"150px",height:"75px"},attrs:{src:e.row.desc_img}})]}}])}),t("el-table-column",{attrs:{label:"医生详情","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.detail))])]}}])}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"220"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleEdit(i.$index,i.row)}}},[e._v("修改")]),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleRemove(i.$index,i.row)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":e.table.currentPage,"page-sizes":[10,20,30,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:e.table.total},on:{"update:currentPage":function(t){return e.$set(e.table,"currentPage",t)},"update:current-page":function(t){return e.$set(e.table,"currentPage",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e.editAddDialog.visible?t("el-dialog",{attrs:{title:e.editAddDialog.title,visible:e.editAddDialog.visible,width:"50%"},on:{"update:visible":function(t){return e.$set(e.editAddDialog,"visible",t)}}},[t("el-form",{ref:"editAddForm",attrs:{"label-position":"left","label-width":"120px",model:e.editAddForm,rules:e.dialogRules}},[t("el-form-item",{attrs:{label:"医生名称",prop:"name"}},[t("el-input",{staticStyle:{width:"60%"},attrs:{maxlength:"20"},model:{value:e.editAddForm.name,callback:function(t){e.$set(e.editAddForm,"name",t)},expression:"editAddForm.name"}})],1),t("el-form-item",{attrs:{label:"医生介绍",prop:"price"}},[t("el-input",{staticStyle:{width:"60%"},attrs:{maxlength:"355"},model:{value:e.editAddForm.desc,callback:function(t){e.$set(e.editAddForm,"desc",t)},expression:"editAddForm.desc"}})],1),t("el-form-item",{attrs:{label:"医生介绍图",prop:"img_id"}},[t("el-upload",{attrs:{action:"http://127.0.0.1:8080/api/upload","http-request":e.myUpload,"on-remove":e.removeUpload,limit:5,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"file-list":e.uploadFileList,"on-success":e.uploadSuccess}},[t("i",{staticClass:"el-icon-plus"})]),t("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),t("el-form-item",{attrs:{label:"医生头像",prop:"details_img_id"}},[t("el-upload",{attrs:{action:"http://127.0.0.1:8080/api/upload","http-request":e.myUploadDetail,"on-remove":e.removeDetailUpload,limit:5,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"file-list":e.uploadDetailFileList,"on-success":e.uploadDetailSuccess}},[t("i",{staticClass:"el-icon-plus"})]),t("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-row",{attrs:{type:"flex",justify:"center"}},[t("el-button",{on:{click:function(t){e.editAddDialog.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitAddEdit}},[e._v("保 存")])],1)],1)],1):e._e()],1)],1)},a=[],s=(i("14d9"),i("d3b7"),i("159b"),i("caad"),i("a15b"),i("25f0"),i("d81d"),{data:function(){return{uploadFileList:[{url:"https://img-blog.csdnimg.cn/f358b00e2d5f44eca9c424864bd943cf.png"}],oldSelectedList:[],detail:[],dialogTableVisible:!1,allImageDisable:!1,logoUploadLimit:1,logofilelist:[],logolist:[],options_lvl_type:[{value:"",label:"--请选择--"},{value:"0",label:"司龄"},{value:"1",label:"活跃值"}],options_limit_type:[{value:"",label:"--请选择--"},{value:"0",label:"年限"},{value:"1",label:"分值"}],grantDialog:{visible:!1},grantTable:{tableLoading:!1,list:[],multipleSelection:[],lvl_id:"",u_id:"",cycle_type:"",equity_cycle:"",equity_nm:"",equity_source:"",equity_type:"",img_url:""},table:{tableLoading:!0,list:[],multipleSelection:[],start:0,limit:10,total:0,currentPage:1},searchForm:{name:""},dialog02:{title:"",type:"",user_id:"",dialogFormVisible:!1},editAddForm:{type_name:"",name:"",type_id:"",group_num:"",price:"",recommend_num:"",id:"",details:""},typeList:[],editAddDialog:{title:"",type:"",visible:!1},dialogRules:{name:[{required:!0,message:"请输入医生名称",trigger:"blur"}],desc:[{required:!0,message:"请输入医生详情",trigger:"blur"}]},productDialog:{visible:!1},downloadLoading:!1,roles:[],uoloadFileListCcs:[]}},created:function(){this.initTypeList(),this.getTableInfo()},methods:{initTypeList:function(){var e=this,t={start:0,limit:1e3};this.ccs.post("/getClassify",t).then((function(t){if("ccs"!=t.code)for(var i=t.rows,l=0;l<i.length;l++)e.typeList.push({label:i[l].name,value:i[l].id});else e.$store.dispatch("LogMessage","初始化商品分类失败!")})).catch((function(t){e.$store.dispatch("LogMessage","初始化商品分类失败!"),console.log(t)}))},handlePictureCardPreview:function(e){console.log(e)},myUpload:function(e){var t=this;console.log("file:"+e);var i=new FormData;i.append("file",e.file),this.ccs.post("upload",i).then((function(e){console.log(e.id),t.uoloadFileListCcs.push(e.id),console.log(t.uoloadFileListCcs)})).catch((function(e){t.$store.dispatch("LogMessage","上传失败!"),console.log(e)}))},myUploadDetail:function(e){var t=this;console.log("file:"+e);var i=new FormData;i.append("file",e.file),this.ccs.post("upload",i).then((function(e){console.log(e.id),t.uoloadDetailFileListCcs.push(e.id),console.log(t.uoloadDetailFileListCcs)})).catch((function(e){t.$store.dispatch("LogMessage","上传失败!"),console.log(e)}))},removeUpload:function(e,t){this.uploadFileList=[],this.uoloadFileListCcs=[]},removeDetailUpload:function(e,t){this.uploadDetailFileList=[],this.this.uoloadDetailFileListCcs=[]},handleSearch:function(){this.table.currentPage=1,this.table.start=0,this.getTableInfo()},handleSearchClear:function(){this.searchForm.lvl_num="",this.searchForm.lvl_name="",this.searchForm.lvl_type=""},handleAdd:function(){this.editAddForm.name="",this.editAddForm.type_id="",this.editAddForm.group_num="",this.editAddForm.price="",this.editAddForm.recommend_num="",this.editAddForm.details="",this.uoloadFileListCcs=[],this.uploadFileList=[],this.uoloadDetailFileListCcs=[],this.uploadDetailFileList=[],this.editAddDialog.title="新增医生",this.editAddDialog.type="add",this.editAddDialog.visible=!0},handleEdit:function(e,t){var i=this;this.editAddForm.details=t.details,this.editAddForm.id=t.id,this.editAddForm.name=t.name,this.editAddForm.type_id=t.type_id,this.editAddForm.type_name=t.type_name,this.editAddForm.group_num=t.group_num,this.editAddForm.price=t.price,this.editAddForm.recommend_num=t.recommend_num,this.uoloadFileListCcs=[],this.uoloadDetailFileListCcs=[],this.editAddDialog.title="修改商品分类",this.editAddDialog.type="edit",this.editAddDialog.visible=!0,this.logolist.length=0,console.log(t.lvl_img_url),this.uploadFileList=[];for(var l=0;l<t.img.length;l++)this.uploadFileList.push({u_id:"",url:t.img[l]});this.uploadDetailFileList=[],this.uploadDetailFileList.push({u_id:"",url:t.dimg}),this.$nextTick((function(){i.$refs["editAddForm"].clearValidate()}))},getTableInfo:function(){var e=this;this.table.tableLoading=!0;var t={name:this.searchForm.name,start:this.table.start,limit:this.table.limit};this.ccs.post("/getDockerPage",t).then((function(t){"ccs"!=t.code&&t.rows&&Array.isArray(t.rows)?(e.table.tableLoading=!1,e.table.list=t.rows,e.table.total=t.total||0):e.$store.dispatch("LogMessage","查询成功!")})).catch((function(t){e.$store.dispatch("LogMessage","查询失败!"),console.log(t)}))},handleRemove:function(e,t){var i=this;this.$confirm("是否将会员等级删除".concat(t.lvl_id,"?"),"提示",{cancelButtonText:"取消",confirmButtonText:"确定",type:"warning"}).then((function(){removeRow({params:{lvl_id:t.lvl_id}}).then((function(e){e.header.msg?i.$message.error(e.header.msg):(i.$message({message:"会员等级删除成功",type:"success"}),i.getTableInfo())})).catch((function(e){console.error(e)}))}))},handleDtl:function(e,t){this.getDtl(t.lvl_id)},getDtl:function(e){var t=this;rowDtl({params:{lvl_id:e}}).then((function(e){e.header.msg?t.$message({type:"warning",message:e.header.msg}):(t.detail=e.body.rows,t.dialogTableVisible=!0)}))},handleSubmit:function(){var e=this;this.$refs["editAddForm"].validate((function(t){if(t)if("add"===e.editAddDialog.type){for(var i="",l=0;l<e.uoloadFileListCcs.length;l++)i+=e.uoloadFileListCcs[l],i+=",";if(e.uoloadFileListCcs.length<3)return void e.$message({type:"warning",message:"医生头像最少需要三张，或图片未上传完成,请稍等后再提交！"});if(0==e.uoloadDetailFileListCcs.length)return void e.$message({type:"warning",message:"未上传商品详情图片或图片未上传完成,请稍等后再提交!"});var a={name:e.editAddForm.name,detail:e.editAddForm.desc,img_id:i.substring(0,i.length-1),desc_img_id:e.uoloadDetailFileListCcs[0]};e.ccs.post("/addDoctor",a).then((function(t){"ccs"!=t.code?(e.$message({message:"添加医生成功",type:"success"}),e.editAddDialog.visible=!1,e.getTableInfo()):e.$store.dispatch("LogMessage","添加医生失败!")})).catch((function(t){e.$store.dispatch("LogMessage","添加医生失败!"),console.log(t)}))}else{var s="";for(l=0;l<e.uoloadFileListCcs.length;l++)s+=e.uoloadFileListCcs[l],s+=",";var o={details:e.editAddForm.details,id:e.editAddForm.id,name:e.editAddForm.name,type_id:e.editAddForm.type_id,group_num:e.editAddForm.group_num,price:e.editAddForm.price,recommend_num:e.editAddForm.recommend_num,img_id:s.substring(0,s.length-1),details_img_id:e.uoloadDetailFileListCcs[0]};e.ccs.post("/editMcd",o).then((function(t){"ccs"!=t.code?(e.$message({message:"编辑成功",type:"success"}),e.editAddDialog.visible=!1,e.getTableInfo()):e.$store.dispatch("LogMessage","编辑失败!")})).catch((function(t){e.$store.dispatch("LogMessage","编辑失败!"),console.log(t)}))}}))},handleGrant:function(e,t){var i=this;this.grantTable.lvl_id=t.lvl_id;var l=t.u_id?t.u_id.split(","):[];this.grantDialog.visible=!0,this.oldSelectedList=[],this.$nextTick((function(){i.$refs.grantTable.clearSelection();for(var e=0;e<l.length;e++)for(var t=0;t<i.grantTable.list.length;t++)if(l[e]===i.grantTable.list[t].u_id){i.oldSelectedList.push(i.grantTable.list[t]),i.$refs.grantTable.toggleRowSelection(i.grantTable.list[t]);break}}))},handleGrantSubmit:function(){var e=this,t=[],i=[],l=[];this.grantTable.multipleSelection.forEach((function(t){var a=!1;e.oldSelectedList.forEach((function(e){e.u_id===t.u_id&&(l.push(t.u_id),console.log("保存后的多选框是:",t.u_id),a=!0)})),a||(i.push(t.u_id),console.log("增加的勾选是:",i))})),0===l.length?this.oldSelectedList.forEach((function(e){t.push(e.u_id)})):this.oldSelectedList.forEach((function(e){l.includes(e.u_id)||t.push(e.u_id)}));var a={equity_del_ids:t.join(","),equity_add_ids:i.join(","),lvl_id:this.grantTable.lvl_id};console.log("需要删除的集合是:",t),console.log("需要添加的集合是:",i),console.log("等级编号id是:",this.grantTable.lvl_id),saveGrant({params:a}).then((function(t){e.grantDialog.visible=!1,"1"!==t.header.retcode?e.$message.error({message:t.header.msg}):(e.$message({message:"授权保存成功",type:"success"}),e.getTableInfo())})).catch((function(t){e.grantDialog.visible=!1,console.error(t)}))},getRightsTableInfo:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this;return new Promise((function(t,i){var l={equity_nm:"",cycle_type:"",equity_type:"",u_id:"",start:e.table.start,limit:e.table.limit};console.log("getRightsTableInfo params: ",l),getRightsTableInfo({params:l}).then((function(i){if(i.header.msg)e.$alert(i.header.msg,"提示",{confirmButtonText:"确定"});else{var l=i.body;console.log("getRoleTableInfo data: ",l);var a=l.rows;if(l.rows&&Array.isArray(l.rows)){for(var s=0;s<a.length;s++){var o=a[s];e.grantTable.list.push({u_id:o.u_id,equity_nm:o.equity_nm,cycle_type:o.cycle_type,equity_cycle:o.equity_cycle,equity_type:o.equity_type,equity_source:o.equity_source,img_url:o.img_url})}e.grantTable.list.length<l.totalCount||t()}}})).catch((function(e){console.error(e),i(e)}))}))})),handleSizeChange:function(e){this.table.currentPage=1,this.table.start=0,this.table.limit=e,this.getTableInfo()},handleCurrentChange:function(e){this.table.start=(e-1)*this.table.limit,this.getTableInfo()},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},handleGrantSelectionChange:function(e){this.grantTable.multipleSelection=e},onLogoChange:function(e){this.logolist=e},handleRemoveLogo:function(e){this.logoWaitUpFlag=!0,this.editAddForm.lvl_img_url="","success"===e.status&&this.form.del_id.push(e.u_id)},uploadLogoSuccess:function(e){var t=this;e&&(this.editAddForm.lvl_img_url=e[0],this.$notify({message:"上传图片成功",type:"success"}),this.allImageDisable=!1,this.$nextTick((function(){t.submitLogoSuccess()})))},submitAddEdit:function(){this.handleSubmit()},submitLogo:function(){this.$refs.logoRef.submit()},submitLogoSuccess:function(){this.handleSubmit()}}}),o=s,n=i("2877"),d=Object(n["a"])(o,l,a,!1,null,null,null);t["default"]=d.exports}}]);