(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2261b2"],{e6f1:function(e,t,i){"use strict";i.r(t);i("b0c0");var a=function(){var e=this,t=e._self._c;return t("el-container",[t("el-main",[t("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{model:e.searchForm,"label-width":"120px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:18}},[t("el-row",{staticClass:"param-row"},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"用户手机号",prop:"phone"}},[t("el-input",{attrs:{maxlength:"60"},model:{value:e.searchForm.phone,callback:function(t){e.$set(e.searchForm,"phone",t)},expression:"searchForm.phone"}})],1)],1)],1),t("el-row",{staticClass:"param-row"})],1),t("el-col",{attrs:{span:6}},[t("el-row",{attrs:{type:"flex",justify:"center"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),t("el-button",{on:{click:e.handleSearchClear}},[e._v("清空")])],1)],1)],1)],1),t("div",{staticClass:"content"},[t("el-alert",{staticClass:"alert",attrs:{title:"",type:"info",closable:!1}},[t("div",{staticClass:"left"},[e._v(" 用户列表 ")])]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.table.tableLoading,expression:"table.tableLoading"}],staticClass:"table",attrs:{data:e.table.list,border:""}},[t("el-table-column",{attrs:{label:"用户序号","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.id))])]}}])}),t("el-table-column",{attrs:{label:"用户手机号","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.phone))])]}}])}),t("el-table-column",{attrs:{label:"用户昵称","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.name))])]}}])}),t("el-table-column",{attrs:{label:"用户状态","min-width":"80",formatter:e.statusFormatter}}),t("el-table-column",{attrs:{label:"账户余额","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.amount))])]}}])}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"360"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleEdit(i.$index,i.row)}}},[e._v("充值")]),0===i.row.status?t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.freeze(i.$index,i.row)}}},[e._v("冻结")]):e._e(),1===i.row.status?t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.freeze(i.$index,i.row)}}},[e._v("解除冻结")]):e._e()]}}])})],1),t("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":e.table.currentPage,"page-sizes":[10,20,30,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:e.table.total},on:{"update:currentPage":function(t){return e.$set(e.table,"currentPage",t)},"update:current-page":function(t){return e.$set(e.table,"currentPage",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e.editAddDialog.visible?t("el-dialog",{attrs:{title:e.editAddDialog.title,visible:e.editAddDialog.visible,width:"50%"},on:{"update:visible":function(t){return e.$set(e.editAddDialog,"visible",t)}}},[t("el-form",{ref:"editAddForm",attrs:{"label-position":"left","label-width":"120px",model:e.editAddForm,rules:e.dialogRules}},[t("el-form-item",{attrs:{label:"用户充值金额",prop:"name"}},[t("el-input",{staticStyle:{width:"60%"},attrs:{maxlength:"5"},model:{value:e.editAddForm.amount,callback:function(t){e.$set(e.editAddForm,"amount",t)},expression:"editAddForm.amount"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-row",{attrs:{type:"flex",justify:"center"}},[t("el-button",{on:{click:function(t){e.editAddDialog.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.recharge}},[e._v("充 值")])],1)],1)],1):e._e()],1)],1)},l=[],o=(i("14d9"),i("d3b7"),i("159b"),i("caad"),i("a15b"),i("25f0"),i("d81d"),{data:function(){return{uploadFileList:[{url:"https://img-blog.csdnimg.cn/f358b00e2d5f44eca9c424864bd943cf.png"}],oldSelectedList:[],detail:[],dialogTableVisible:!1,allImageDisable:!1,logoUploadLimit:1,logofilelist:[],logolist:[],options_lvl_type:[{value:"",label:"--请选择--"},{value:"0",label:"司龄"},{value:"1",label:"活跃值"}],options_limit_type:[{value:"",label:"--请选择--"},{value:"0",label:"年限"},{value:"1",label:"分值"}],grantDialog:{visible:!1},grantTable:{tableLoading:!1,list:[],multipleSelection:[],lvl_id:"",u_id:"",cycle_type:"",equity_cycle:"",equity_nm:"",equity_source:"",equity_type:"",img_url:""},table:{tableLoading:!0,list:[],multipleSelection:[],start:0,limit:10,total:0,currentPage:1},searchForm:{name:""},dialog02:{title:"",type:"",user_id:"",dialogFormVisible:!1},editAddForm:{amount:0,name:"",order:"",id:""},editAddDialog:{title:"",type:"",visible:!1},dialogRules:{amount:[{required:!0,message:"请输入充值金额",trigger:"blur"}]},productDialog:{visible:!1},downloadLoading:!1,roles:[],uoloadFileListCcs:[]}},created:function(){this.getTableInfo()},methods:{statusFormatter:function(e,t){var i=e.status;return 0==i?"正常":1==i?"冻结":void 0},handlePictureCardPreview:function(e){console.log(e)},recharge:function(){var e=this,t={phone:this.editAddForm.phone,amount:this.editAddForm.amount};this.ccs.post("chnl/rechargeUserAmount",t).then((function(t){e.$message({message:t.msg,type:"success"}),e.editAddDialog.visible=!1,e.getTableInfo()}))},freeze:function(e,t){var i=this,a={userPhone:t.phone};this.ccs.post("freeze",a).then((function(e){i.$message({message:e.msg,type:"success"}),i.getTableInfo()}))},myUpload:function(e){var t=this;console.log("file:"+e);var i=new FormData;i.append("file",e.file),this.ccs.post("upload",i).then((function(e){console.log(e.id),t.uoloadFileListCcs.push(e.id),console.log(t.uoloadFileListCcs)})).catch((function(e){t.$message({type:"error",message:"上传失败！"}),console.log(e)}))},removeUpload:function(e,t){this.uploadFileList=[],this.uoloadFileListCcs=[]},handleSearch:function(){this.table.currentPage=1,this.table.start=0,this.getTableInfo()},handleSearchClear:function(){this.searchForm.lvl_num="",this.searchForm.lvl_name="",this.searchForm.lvl_type=""},handleEdit:function(e,t){var i=this;this.editAddForm.phone=t.phone,this.editAddDialog.type="edit",this.editAddDialog.visible=!0,console.log(t.lvl_img_url),this.$nextTick((function(){i.$refs["editAddForm"].clearValidate()}))},getTableInfo:function(){var e=this;this.table.tableLoading=!0;var t={phone:this.searchForm.phone,start:this.table.start,limit:this.table.limit};this.ccs.post("/chnl/getUserList",t).then((function(t){"ccs"!=t.code&&t.rows&&Array.isArray(t.rows)?(e.table.tableLoading=!1,e.table.list=t.rows,e.table.total=t.total||0):e.$message({type:"error",message:"查询失败"})})).catch((function(t){e.$message({type:"error",message:"查询失败"}),console.log(t)}))},handleRemove:function(e,t){var i=this;this.$confirm("是否将会员等级删除".concat(t.lvl_id,"?"),"提示",{cancelButtonText:"取消",confirmButtonText:"确定",type:"warning"}).then((function(){removeRow({params:{lvl_id:t.lvl_id}}).then((function(e){e.header.msg?i.$message.error(e.header.msg):(i.$message({message:"会员等级删除成功",type:"success"}),i.getTableInfo())})).catch((function(e){console.error(e)}))}))},handleDtl:function(e,t){this.getDtl(t.lvl_id)},getDtl:function(e){var t=this;rowDtl({params:{lvl_id:e}}).then((function(e){e.header.msg?t.$message({type:"warning",message:e.header.msg}):(t.detail=e.body.rows,t.dialogTableVisible=!0)}))},handleSubmit:function(){var e=this;this.$refs["editAddForm"].validate((function(t){if(t)if("add"===e.editAddDialog.type){var i={name:e.editAddForm.name,order_num:e.editAddForm.order_num,img_id:e.uoloadFileListCcs[0]};e.ccs.post("/addClassify",i).then((function(t){"ccs"!=t.code?(e.$message({message:"保存成功",type:"success"}),e.editAddDialog.visible=!1,e.getTableInfo()):e.$message({type:"error",message:"保存失败"})})).catch((function(t){e.$message({type:"error",message:"保存失败"}),console.log(t)}))}else{var a={name:e.editAddForm.name,order_num:e.editAddForm.order_num,img_id:e.uoloadFileListCcs[0],id:e.editAddForm.id};e.ccs.post("/editClassify",a).then((function(t){"ccs"!=t.code?(e.$message({message:"编辑成功",type:"success"}),e.editAddDialog.visible=!1,e.getTableInfo()):e.$message({type:"error",message:"编辑失败"})})).catch((function(t){e.$message({type:"error",message:"编辑失败"}),console.log(t)}))}}))},handleGrant:function(e,t){var i=this;this.grantTable.lvl_id=t.lvl_id;var a=t.u_id?t.u_id.split(","):[];this.grantDialog.visible=!0,this.oldSelectedList=[],this.$nextTick((function(){i.$refs.grantTable.clearSelection();for(var e=0;e<a.length;e++)for(var t=0;t<i.grantTable.list.length;t++)if(a[e]===i.grantTable.list[t].u_id){i.oldSelectedList.push(i.grantTable.list[t]),i.$refs.grantTable.toggleRowSelection(i.grantTable.list[t]);break}}))},handleGrantSubmit:function(){var e=this,t=[],i=[],a=[];this.grantTable.multipleSelection.forEach((function(t){var l=!1;e.oldSelectedList.forEach((function(e){e.u_id===t.u_id&&(a.push(t.u_id),console.log("保存后的多选框是:",t.u_id),l=!0)})),l||(i.push(t.u_id),console.log("增加的勾选是:",i))})),0===a.length?this.oldSelectedList.forEach((function(e){t.push(e.u_id)})):this.oldSelectedList.forEach((function(e){a.includes(e.u_id)||t.push(e.u_id)}));var l={equity_del_ids:t.join(","),equity_add_ids:i.join(","),lvl_id:this.grantTable.lvl_id};console.log("需要删除的集合是:",t),console.log("需要添加的集合是:",i),console.log("等级编号id是:",this.grantTable.lvl_id),saveGrant({params:l}).then((function(t){e.grantDialog.visible=!1,"1"!==t.header.retcode?e.$message.error({message:t.header.msg}):(e.$message({message:"授权保存成功",type:"success"}),e.getTableInfo())})).catch((function(t){e.grantDialog.visible=!1,console.error(t)}))},getRightsTableInfo:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this;return new Promise((function(t,i){var a={equity_nm:"",cycle_type:"",equity_type:"",u_id:"",start:e.table.start,limit:e.table.limit};console.log("getRightsTableInfo params: ",a),getRightsTableInfo({params:a}).then((function(i){if(i.header.msg)e.$alert(i.header.msg,"提示",{confirmButtonText:"确定"});else{var a=i.body;console.log("getRoleTableInfo data: ",a);var l=a.rows;if(a.rows&&Array.isArray(a.rows)){for(var o=0;o<l.length;o++){var s=l[o];e.grantTable.list.push({u_id:s.u_id,equity_nm:s.equity_nm,cycle_type:s.cycle_type,equity_cycle:s.equity_cycle,equity_type:s.equity_type,equity_source:s.equity_source,img_url:s.img_url})}e.grantTable.list.length<a.totalCount||t()}}})).catch((function(e){console.error(e),i(e)}))}))})),handleSizeChange:function(e){this.table.currentPage=1,this.table.start=0,this.table.limit=e,this.getTableInfo()},handleCurrentChange:function(e){this.table.start=(e-1)*this.table.limit,this.getTableInfo()},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},handleGrantSelectionChange:function(e){this.grantTable.multipleSelection=e},onLogoChange:function(e){this.logolist=e},handleRemoveLogo:function(e){this.logoWaitUpFlag=!0,this.editAddForm.lvl_img_url="","success"===e.status&&this.form.del_id.push(e.u_id)},uploadLogoSuccess:function(e){var t=this;e&&(this.editAddForm.lvl_img_url=e[0],this.$notify({message:"上传图片成功",type:"success"}),this.allImageDisable=!1,this.$nextTick((function(){t.submitLogoSuccess()})))},submitAddEdit:function(){this.handleSubmit()},submitLogo:function(){this.$refs.logoRef.submit()},submitLogoSuccess:function(){this.handleSubmit()}}}),s=o,n=i("2877"),r=Object(n["a"])(s,a,l,!1,null,null,null);t["default"]=r.exports}}]);